<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Image Classifier - AI vs Real Image Detector</title>
  <style>
    /* Reset & base */
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f0f2f5;
      color: #333;
      line-height: 1.6;
    }
    a {
      text-decoration: none;
      color: #333;
      cursor: pointer;
    }
    a:hover {
      color: #007bff;
    }

    /* Smooth scrolling */
    html {
      scroll-behavior: smooth;
    }

    /* Navigation Bar */
    nav {
      background-color: #ffffff;
      box-shadow: 0 2px 5px rgba(0,0,0,0.08);
      position: sticky;
      top: 0;
      z-index: 1000;
    }
    nav .nav-container {
      max-width: 1100px;
      margin: 0 auto;
      padding: 10px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
    }
    nav .logo {
      font-weight: 700;
      font-size: 20px;
      letter-spacing: 2px;
      color: #007bff;
      user-select: none;
      font-family: 'Montserrat', sans-serif;
    }
    nav ul {
      list-style: none;
      display: flex;
      gap: 20px;
      margin: 0;
      padding: 0;
    }
    nav ul li {
      font-weight: 600;
      font-size: 15px;
    }

    /* Header Section */
    header {
      text-align: center;
      padding: 48px 20px 30px;
      background: linear-gradient(135deg, #007bff 0%, #00c6ff 100%);
      color: white;
      font-family: 'Montserrat', sans-serif;
    }
    header h1 {
      font-size: 40px;
      font-weight: 900;
      letter-spacing: 4px;
      margin: 0 0 10px 0;
      text-transform: uppercase;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.18);
    }
    header p {
      font-size: 18px;
      max-width: 720px;
      margin: 0 auto;
      font-weight: 300;
      line-height: 1.4;
    }

    /* Main Content */
    main {
      max-width: 920px;
      margin: 30px auto 80px;
      padding: 0 16px;
    }

    /* Section styling */
    section {
      background: white;
      padding: 26px 32px;
      border-radius: 12px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.06);
      margin-bottom: 32px;
    }

    /* Section Titles */
    section h2 {
      font-family: 'Montserrat', sans-serif;
      font-weight: 700;
      font-size: 24px;
      margin-bottom: 12px;
      color: #007bff;
      border-left: 5px solid #007bff;
      padding-left: 10px;
    }
    section p {
      font-size: 16px;
      color: #555;
      margin-bottom: 18px;
      line-height: 1.6;
    }

    /* Upload area */
    .upload-section {
      border: 2px dashed #007bff;
      text-align: center;
      margin-top: 10px;
      padding: 20px;
      border-radius: 10px;
      transition: background-color 0.15s ease;
    }
    .upload-section.dragover {
      background-color: rgba(0,123,255,0.04);
    }
    .upload-controls {
      display: flex;
      gap: 12px;
      align-items: center;
      justify-content: center;
      flex-wrap: wrap;
      margin-top: 12px;
    }
    .upload-section input[type="file"] {
      display: none;
    }
    .btn {
      display: inline-block;
      padding: 10px 18px;
      border-radius: 8px;
      font-weight: 700;
      cursor: pointer;
      border: none;
    }
    .btn-primary {
      background-color: #007bff;
      color: #fff;
    }
    .btn-ghost {
      background: transparent;
      border: 2px solid #007bff;
      color: #007bff;
    }
    .btn[disabled] {
      opacity: 0.6;
      cursor: not-allowed;
    }

    #previewContainer img {
      max-width: 100%;
      max-height: 320px;
      margin-top: 18px;
      border-radius: 10px;
      border: 1px solid #ddd;
      box-shadow: 0 6px 20px rgba(0,0,0,0.06);
    }

    .loading {
      margin-top: 12px;
      font-style: italic;
      color: #555;
      font-weight: 700;
    }
    .result {
      margin-top: 18px;
      font-size: 18px;
      font-weight: 800;
      color: #333;
      min-height: 36px;
    }
    .confidence {
      display: inline-block;
      margin-left: 8px;
      font-weight: 700;
      color: #333;
      font-size: 15px;
    }
    .result.real { color: #15803d; }       /* green */
    .result.ai { color: #b91c1c; }         /* red */
    .error {
      margin-top: 14px;
      color: #cc0000;
      font-weight: 700;
    }
    .meta {
      margin-top: 10px;
      font-size: 13px;
      color: #666;
    }
    .small {
      font-size: 13px;
      color: #666;
    }

    /* Responsive */
    @media (max-width: 640px) {
      header h1 { font-size: 30px; }
      nav .nav-container { flex-direction: column; gap: 8px; align-items: start; }
      #previewContainer img { max-height: 220px; }
      main { margin: 18px auto 60px; }
      section { padding: 16px; }
    }
  </style>
</head>
<body>
  <!-- Navigation Bar -->
  <nav>
    <div class="nav-container">
      <div class="logo">IMAGE CLASSIFIER</div>
      <ul>
        <li><a href="#top" id="homeLink">Home</a></li>
        <li><a href="#image-detector">Image Detector</a></li>
        <li><a href="#video-detector">Video Detector</a></li>
        <li><a href="#about">About</a></li>
      </ul>
    </div>
  </nav>

  <div id="top"></div>

  <!-- Header Section -->
  <header>
    <h1>IMAGE CLASSIFIER</h1>
    <p>
      Detect whether an image is a real photograph or generated by artificial intelligence. This demo shows a client-side prediction when no backend is configured; replace the demo with your server endpoint to use a real model.
    </p>
  </header>

  <!-- Main Content -->
  <main>
    <section id="about">
      <h2>About This Website</h2>
      <p>
        This project demonstrates a simple image detector UI. The real detection should happen on a backend ML model (or via an external API). For quick testing the page uses a deterministic demo classifier when the API URL is left as the placeholder.
      </p>
    </section>

    <section id="image-detector" class="upload-section" aria-labelledby="image-detector-title" role="region">
      <h2 id="image-detector-title">Try It Now</h2>

      <div id="dropZone" class="upload-section">
        <p class="small">Drag & drop an image here, or click <button id="chooseBtn" class="btn btn-ghost">Choose Image</button></p>
        <input type="file" id="imageInput" accept="image/*" aria-label="Choose an image" />
        <div class="upload-controls">
          <button id="uploadBtn" class="btn btn-primary" disabled>Check Image</button>
          <label class="small" title="Toggle whether to use demo prediction when no backend is set">
            <input type="checkbox" id="demoToggle" checked /> Use demo when backend missing
          </label>
        </div>

        <div id="previewContainer" aria-live="polite"></div>

        <div class="loading" id="loading" style="display:none;">Analyzing image...</div>
        <div class="result" id="result" aria-live="polite"></div>
        <div class="meta" id="meta"></div>
        <div class="error" id="error" aria-live="assertive"></div>
      </div>
    </section>

    <section id="video-detector">
      <h2>Video Detector</h2>
      <p>Video detection feature coming soon!</p>
    </section>
  </main>

  <script>
    /***************
     * Configuration
     ***************/
    // Replace this with your backend endpoint when ready.
    // Example: const API_URL = 'https://api.yourdomain.com/predict';
const API_URL = 'http://127.0.0.1:5000/predict';
 // placeholder -> demo mode used if unchanged

    // If true, the page will simulate a prediction when API_URL is the placeholder (convenient for testing).
    let useDemoWhenNoBackend = true;

    /*********************
     * DOM element binding
     *********************/
    const imageInput = document.getElementById('imageInput');
    const chooseBtn = document.getElementById('chooseBtn');
    const previewContainer = document.getElementById('previewContainer');
    const uploadBtn = document.getElementById('uploadBtn');
    const loadingText = document.getElementById('loading');
    const resultText = document.getElementById('result');
    const metaText = document.getElementById('meta');
    const errorText = document.getElementById('error');
    const dropZone = document.getElementById('dropZone');
    const demoToggle = document.getElementById('demoToggle');

    let selectedFile = null;
    const MAX_FILE_SIZE = 6 * 1024 * 1024; // 6 MB

    /*****************
     * Utility helpers
     *****************/
    function resetUI() {
      errorText.textContent = '';
      resultText.textContent = '';
      previewContainer.innerHTML = '';
      metaText.textContent = '';
      loadingText.style.display = 'none';
    }

    function showError(msg) {
      errorText.textContent = 'Error: ' + msg;
    }

    function humanFileSize(bytes) {
      const thresh = 1024;
      if (Math.abs(bytes) < thresh) return bytes + ' B';
      const units = ['KB','MB','GB','TB','PB','EB','ZB','YB'];
      let u = -1;
      do {
        bytes /= thresh;
        ++u;
      } while(Math.abs(bytes) >= thresh && u < units.length - 1);
      return bytes.toFixed(1)+' '+units[u];
    }

    /****************
     * File selection
     ****************/
    chooseBtn.addEventListener('click', () => imageInput.click());
    imageInput.addEventListener('change', handleFileSelect);

    function handleFileSelect() {
      resetUI();
      if (imageInput.files && imageInput.files[0]) {
        const file = imageInput.files[0];
        validateAndPreview(file);
      }
    }

    // Drag & drop
    ['dragenter','dragover'].forEach(ev => {
      dropZone.addEventListener(ev, (e) => {
        e.preventDefault();
        e.stopPropagation();
        dropZone.classList.add('dragover');
      });
    });
    ['dragleave','drop','dragend'].forEach(ev => {
      dropZone.addEventListener(ev, (e) => {
        e.preventDefault();
        e.stopPropagation();
        dropZone.classList.remove('dragover');
      });
    });
    dropZone.addEventListener('drop', (e) => {
      const dt = e.dataTransfer;
      const files = dt && dt.files;
      if (files && files[0]) {
        validateAndPreview(files[0]);
      }
    });

    function validateAndPreview(file) {
      errorText.textContent = '';
      resultText.textContent = '';
      metaText.textContent = '';

      // simple checks
      if (!file.type.startsWith('image/')) {
        showError('Please upload a valid image file.');
        return;
      }
      if (file.size > MAX_FILE_SIZE) {
        showError('File too large. Max allowed: ' + humanFileSize(MAX_FILE_SIZE));
        return;
      }

      selectedFile = file;
      uploadBtn.disabled = false;

      // preview
      const reader = new FileReader();
      reader.onload = function(e) {
        previewContainer.innerHTML = `<img src="${e.target.result}" alt="Image Preview" />`;
        metaText.textContent = `File: ${file.name} — ${humanFileSize(file.size)} — ${file.type}`;
      };
      reader.readAsDataURL(file);
    }

    /*********************
     * Prediction workflow
     *********************/
    uploadBtn.addEventListener('click', () => {
      if (!selectedFile) return;
      errorText.textContent = '';
      resultText.textContent = '';
      loadingText.style.display = 'block';
      uploadBtn.disabled = true;
      imageInput.disabled = true;
      chooseBtn.disabled = true;

      // If API_URL is unchanged placeholder and demo allowed -> simulate prediction
      const isPlaceholder = API_URL.includes('your-backend-api.com');
      if (isPlaceholder && demoToggle.checked && useDemoWhenNoBackend) {
        simulatePrediction(selectedFile)
          .then(displayPrediction)
          .catch(err => showError(err.message || String(err)))
          .finally(resetControls);
        return;
      }

      // Otherwise, call backend API
      const formData = new FormData();
      formData.append('image', selectedFile);

      fetch(API_URL, {
        method: 'POST',
        body: formData
      })
      .then(async (response) => {
        loadingText.style.display = 'none';
        if (!response.ok) {
          // try to extract message
          let text = await response.text().catch(() => '');
          throw new Error('Server error: ' + response.status + (text ? ' — ' + text : ''));
        }
        return response.json();
      })
      .then((data) => {
        // expected: { prediction: "Real"|"AI-generated", confidence: 0.0-1.0 }
        if (data && (data.prediction || typeof data.confidence === 'number')) {
          displayPrediction({
            prediction: data.prediction || 'Unknown',
            confidence: typeof data.confidence === 'number' ? data.confidence : null
          });
        } else {
          throw new Error('Unexpected response format from server.');
        }
      })
      .catch((error) => {
        showError(error.message || String(error));
      })
      .finally(resetControls);
    });

    function resetControls() {
      loadingText.style.display = 'none';
      uploadBtn.disabled = false;
      imageInput.disabled = false;
      chooseBtn.disabled = false;
    }

    /************************
     * Demo prediction logic
     *
     * This is intentionally simple and deterministic:
     * - It reads the image dimensions (via an Image object)
     * - Combines width+height with file size to produce a pseudo confidence
     * - Uses a threshold to call something "AI-generated" or "Real"
     * This is only for UI/demo purposes and is NOT a real detector.
     ************************/
    function simulatePrediction(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onerror = () => reject(new Error('Failed to read file for demo prediction.'));
        reader.onload = function(e) {
          const img = new Image();
          img.onload = function() {
            // deterministic pseudo-randomish heuristic:
            // compute a score from image dimensions and size
            const area = img.width * img.height;
            const size = file.size;
            // normalized factors
            const factor = Math.log10(size + 1) * 0.4 + Math.log10(Math.max(area,1)+1)*0.6;
            // clamp to [0,1]
            let confidence = Math.tanh(factor / 6); // scale -> 0..~1
            // add small deterministic jitter based on filename chars so results vary by file
            const nameSeed = Array.from(file.name).reduce((acc,c)=>acc + c.charCodeAt(0), 0);
            confidence = Math.min(0.995, Math.max(0.01, confidence + ((nameSeed % 11) - 5)/200));

            // threshold: if width or height even number-ish or very large -> label AI-generated (arbitrary)
            const odd = (img.width + img.height + (size % 100)) % 2;
            const predicted = (confidence > 0.6 || odd === 0) ? 'AI-generated' : 'Real';
            // invert confidence for 'Real' (so real near 1 means high confidence real)
            const finalConfidence = predicted === 'AI-generated' ? confidence : 1 - confidence;

            // small timeout to simulate network latency
            setTimeout(() => {
              resolve({ prediction: predicted, confidence: finalConfidence });
            }, 650 + (nameSeed % 300));
          };
          img.onerror = () => reject(new Error('Invalid image data for demo prediction.'));
          img.src = e.target.result;
        };
        reader.readAsDataURL(file);
      });
    }

    /*********************
     * Display result nicely
     *********************/
    function displayPrediction({ prediction, confidence }) {
      loadingText.style.display = 'none';
      errorText.textContent = '';

      const confText = (typeof confidence === 'number') ? `Confidence: ${(confidence * 100).toFixed(2)}%` : 'Confidence: N/A';

      resultText.classList.remove('real', 'ai');
      if (/ai/i.test(prediction) || /generated/i.test(prediction)) {
        resultText.classList.add('ai');
        resultText.innerHTML = `Prediction: <span style="text-transform:uppercase">${prediction}</span><span class="confidence"> — ${confText}</span>`;
      } else {
        resultText.classList.add('real');
        resultText.innerHTML = `Prediction: <span style="text-transform:uppercase">${prediction}</span><span class="confidence"> — ${confText}</span>`;
      }
    }

    /****************
     * Accessibility
     ****************/
    // Provide keyboard shortcut: Ctrl+U to open file dialog
    window.addEventListener('keydown', (e) => {
      if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 'u') {
        e.preventDefault();
        imageInput.click();
      }
    });

    // initial helpful tip
    metaText.textContent = 'Tip: press Ctrl+U to choose a file. Demo predictions used if backend not configured.';
  </script>
</body>
</html>
